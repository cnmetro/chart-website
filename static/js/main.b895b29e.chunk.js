(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{124:function(e,a,t){e.exports=t.p+"static/media/logo.cd5e6a7c.svg"},142:function(e,a,t){e.exports=t(316)},147:function(e,a,t){},149:function(e,a,t){},182:function(e,a,t){},313:function(e,a,t){},316:function(e,a,t){"use strict";t.r(a);var n=t(1),r=t.n(n),c=t(58),o=t.n(c),i=(t(147),t(36)),l=t(37),s=t(42),u=t(38),m=t(43),h=(t(149),t(124)),v=t.n(h),d=t(140),p=t(59),y=t.n(p),g=t(125),f=t.n(g),E=t(126),b=t.n(E),k=t(127),N=t.n(k),D=(t(182),t(322)),j=t(311),w=t(312),q=t(321),O=t(319),C=t(123),A=t(318),Y=function(e){function a(){var e,t;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(t=Object(s.a)(this,(e=Object(u.a)(a)).call.apply(e,[this].concat(r)))).state={data:[],query:"count=30"},t}return Object(m.a)(a,e),Object(l.a)(a,[{key:"request",value:function(e,a){return y.a.get("http://metro.sinchang.me/api/flows?city=".concat(a,"&").concat(e)).then(function(e){return e.data})}},{key:"requestAll",value:function(e){return Promise.all([this.request(e,"sh"),this.request(e,"bj"),this.request(e,"gz")])}},{key:"lastThirtyDays",value:function(){return Object(d.a)(new Array(30)).map(function(e,a){return N()(b()(f()(),a),"YYYY-MM-DD")})}},{key:"getDayNum",value:function(e,a){var t=0;return e.forEach(function(e){e.date===a&&(t=e.num)}),t}},{key:"formatData",value:function(e){var a=this,t=[];this.lastThirtyDays().forEach(function(n){t.push({date:n,Shanghai:a.getDayNum(e[0].data,n),Beijing:a.getDayNum(e[1].data,n),Guangzhou:a.getDayNum(e[2].data,n)})}),this.setState({data:t.reverse()})}},{key:"componentDidMount",value:function(){var e=this;this.requestAll(this.state.query).then(function(a){e.formatData(a)})}},{key:"render",value:function(){return r.a.createElement("div",{className:""},r.a.createElement(D.a,{width:1e3,height:500,data:this.state.data,margin:{top:5,right:30,left:20,bottom:5}},r.a.createElement(j.a,{dataKey:"date"}),r.a.createElement(w.a,null),r.a.createElement(q.a,{strokeDasharray:"3 3"}),r.a.createElement(O.a,null),r.a.createElement(C.a,null),r.a.createElement(A.a,{type:"monotone",dataKey:"Shanghai",stroke:"#8884d8"}),r.a.createElement(A.a,{type:"monotone",dataKey:"Beijing",stroke:"#82ca9d"}),r.a.createElement(A.a,{type:"monotone",dataKey:"Guangzhou",stroke:"#1281ca"})))}}]),a}(n.Component),x=(t(313),{sh:"#8884d8",bj:"#82ca9d",gz:"#1281ca"}),M=function(e){function a(){var e,t;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(t=Object(s.a)(this,(e=Object(u.a)(a)).call.apply(e,[this].concat(r)))).state={name:"",query:"count=30",data:[],sortedData:[]},t.handleChange=function(e){t.fetchData(null,e.target.value)},t}return Object(m.a)(a,e),Object(l.a)(a,[{key:"request",value:function(e,a){return y.a.get("http://metro.sinchang.me/api/flows?city=".concat(a,"&").concat(e)).then(function(e){return e.data})}},{key:"componentDidMount",value:function(){var e=this,a=this.props.match.params.name;this.fetchData(a),this.request("sort=desc",a).then(function(a){e.setState({sortedData:a.data})})}},{key:"componentWillReceiveProps",value:function(e){var a=this,t=e.match.params.name;t!==this.state.name&&(this.fetchData(t),this.request("sort=desc",t).then(function(e){a.setState({sortedData:e.data})}))}},{key:"fetchData",value:function(e,a){var t=this;e=e||this.state.name,a=a||this.state.query,this.request(a,e).then(function(n){t.setState({data:n.data.reverse(),name:e,query:a})})}},{key:"render",value:function(){var e=this.state.sortedData[0],a=this.state.sortedData[this.state.sortedData.length-1];return r.a.createElement("div",null,r.a.createElement("select",{className:"form-control type-select",value:this.state.query,onChange:this.handleChange},r.a.createElement("option",{value:"count=30"},"The last 30 Days"),r.a.createElement("option",{value:"count=10&sort=desc"},"Top10"),r.a.createElement("option",{value:"year=2019"},"2019 Year"),r.a.createElement("option",{value:"year=2018"},"2018 Year"),r.a.createElement("option",{value:"year=2017"},"2017 Year"),r.a.createElement("option",{value:"year=2016"},"2016 Year"),r.a.createElement("option",{value:"year=2015"},"2015 Year")),r.a.createElement(D.a,{width:1e3,height:500,data:this.state.data,margin:{top:5,right:30,left:20,bottom:5}},r.a.createElement(j.a,{dataKey:"date"}),r.a.createElement(w.a,null),r.a.createElement(q.a,{strokeDasharray:"3 3"}),r.a.createElement(O.a,null),r.a.createElement(C.a,null),r.a.createElement(A.a,{type:"monotone",dataKey:"num",stroke:x[this.state.name]})),r.a.createElement("div",null,e&&r.a.createElement("span",null,"Highest: ",e.num," in ",e.date)," | ",a&&r.a.createElement("span",null,"Lowest: ",a.num," in ",a.date)))}}]),a}(n.Component),S=t(323),z=t(324),K=t(317),T=function(e){function a(){return Object(i.a)(this,a),Object(s.a)(this,Object(u.a)(a).apply(this,arguments))}return Object(m.a)(a,e),Object(l.a)(a,[{key:"activeEvent",value:function(e,a){return!!e&&(e.url===a.pathname||void 0)}},{key:"render",value:function(){return r.a.createElement(S.a,null,r.a.createElement("div",{className:"app"},r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},r.a.createElement("a",{className:"navbar-brand",href:"/"},r.a.createElement("img",{src:v.a,width:"30",height:"30",className:"d-inline-block align-top",alt:"logo"})),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNavAltMarkup","aria-controls":"navbarNavAltMarkup","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarNavAltMarkup"},r.a.createElement("div",{className:"navbar-nav"},r.a.createElement(z.a,{className:"nav-item nav-link",to:"/",activeClassName:"active",isActive:this.activeEvent},"Home"),r.a.createElement(z.a,{className:"nav-item nav-link",to:"/city/sh",activeClassName:"active"},"Shanghai"),r.a.createElement(z.a,{className:"nav-item nav-link",to:"/city/bj",activeClassName:"active"},"Beijing"),r.a.createElement(z.a,{className:"nav-item nav-link",to:"/city/gz",activeClassName:"active"},"Guangzhou")))),r.a.createElement("p",{className:"tip-text"},"(unit: Ten thousand)"),r.a.createElement(K.a,{exact:!0,path:"/",component:Y}),r.a.createElement(K.a,{exact:!0,path:"/city/:name",component:M})))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(T,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[142,2,1]]]);
//# sourceMappingURL=main.b895b29e.chunk.js.map